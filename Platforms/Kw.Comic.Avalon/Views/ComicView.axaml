<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:sys="using:System"
             xmlns:m="using:Kw.Comic.Avalon.Designings"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="Kw.Comic.Avalon.Views.ComicView">
  <Design.DataContext>
    <m:DesigningComicSnapshotInfo/>
  </Design.DataContext>
  <UserControl.Resources>
    <Thickness x:Key="IconMargin">0,0,12,0</Thickness>
    <Thickness x:Key="DescMargin">0,0,12,0</Thickness>
    <Thickness x:Key="ItemMargin">0,4</Thickness>
    <sys:Double x:Key="DescFontSize">16</sys:Double>
  </UserControl.Resources>
  <Grid Margin="6,0">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <Grid Grid.Row="0">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
      <Border>
        <Image Source="{Binding LogoImage}"
               Stretch="UniformToFill"
               Width="280"/>
      </Border>
      <StackPanel Grid.Column="1"
            Orientation="Vertical"
            Margin="35,0,0,0">
        <TextBlock Text="{Binding Snapshot.Name}" FontSize="26"/>
        <Grid Margin="{StaticResource ItemMargin}">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>
          <TextBlock Classes="segoblock" FontSize="{StaticResource DescFontSize}" Text="&#xE8B8;" Margin="{StaticResource DescMargin}" VerticalAlignment="Center"/>
          <TextBlock Text="{Binding Snapshot.Author}"
                     FontSize="{StaticResource DescFontSize}"
                     Grid.Column="1"/>
        </Grid>
        <ItemsControl Items="{Binding Snapshot.Sources}" Margin="{StaticResource ItemMargin}">
          <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
              <StackPanel Orientation="Horizontal"/>
            </ItemsPanelTemplate>
          </ItemsControl.ItemsPanel>
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <Button FontSize="{StaticResource DescFontSize}"
                      Margin="6">
                <StackPanel Orientation="Horizontal">
                  <TextBlock Text="{Binding Name}"
                             Grid.Column="1">
                  </TextBlock>
                </StackPanel>
              </Button>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
        <Grid Margin="{StaticResource DescMargin}">
          <TextBlock Text="{Binding Snapshot.Descript}"
                     FontSize="{StaticResource DescFontSize}"
                     MaxHeight="300"
                     TextWrapping="Wrap"
                     Grid.Column="1">
            <ToolTip.Tip>
              <TextBlock Text="{Binding Snapshot.Descript}"
                         TextWrapping="Wrap"
                         MaxWidth="400"/>
            </ToolTip.Tip>
          </TextBlock>
        </Grid>
      </StackPanel>
    </Grid>
    <Border Grid.Row="1"
            Margin="0,15,0,0"
            HorizontalAlignment="Center">
      <TextBlock FontSize="22">引用源</TextBlock>
    </Border>
    <ScrollViewer Grid.Row="2">
      <ItemsControl Items="{Binding SourceInfos}"
                FontSize="14">
        <ItemsControl.ItemTemplate>
          <DataTemplate>
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
              </Grid.ColumnDefinitions>
              <StackPanel Orientation="Horizontal"
                          Margin="20">
                <ToolTip.Tip>
                  <Grid>
                    <TextBlock IsVisible="{Binding CanParse}">可以被解析</TextBlock>
                    <TextBlock IsVisible="{Binding CanParse,Converter={StaticResource RevBoolConverter},ConverterParameter=rev}">无法被解析</TextBlock>
                  </Grid>
                </ToolTip.Tip>
                <TextBlock Classes="segoblock" IsVisible="{Binding CanParse}" FontSize="{StaticResource DescFontSize}" Text="&#xE8FB;" Margin="{StaticResource DescMargin}" VerticalAlignment="Center"/>
                <TextBlock Classes="segoblock" IsVisible="{Binding CanParse,Converter={StaticResource RevBoolConverter}}" FontSize="{StaticResource DescFontSize}" Text="&#xE894;" Margin="{StaticResource DescMargin}" VerticalAlignment="Center"/>

                <TextBlock Text="{Binding Source.Name}"
                           Margin="6,0"
                           VerticalAlignment="Center"/>
                <Button Content="{Binding Source.TargetUrl}"
                        Command="{Binding OpenCommand}"/>
              </StackPanel>
              <StackPanel Orientation="Horizontal"
                          Grid.Column="1"
                          HorizontalAlignment="Right">
                <StackPanel.Resources>
                  <Thickness x:Key="BlockMargin">6,0</Thickness>
                </StackPanel.Resources>
                <Button Command="{Binding WatchCommand}" IsVisible="{Binding CanParse}">
                  <StackPanel Orientation="Horizontal">
                    <TextBlock Classes="segoblock" FontSize="{StaticResource DescFontSize}" Text="&#xE768;" Margin="{StaticResource DescMargin}" VerticalAlignment="Center"/>
                    <TextBlock VerticalAlignment="Center">进入</TextBlock>
                  </StackPanel>
                </Button>
                <Button Command="{Binding OpenCommand}"
                        Margin="{StaticResource BlockMargin}">
                  <StackPanel Orientation="Horizontal">
                    <TextBlock Classes="segoblock" FontSize="{StaticResource DescFontSize}" Text="&#xE753;" Margin="{StaticResource DescMargin}" VerticalAlignment="Center"/>
                    <TextBlock VerticalAlignment="Center">打开</TextBlock>
                  </StackPanel>
                </Button>
                <Button Command="{Binding CopyCommand}"
                        Margin="{StaticResource BlockMargin}">
                  <StackPanel Orientation="Horizontal">
                    <TextBlock Classes="segoblock" FontSize="{StaticResource DescFontSize}" Text="&#xE8A5;" Margin="{StaticResource DescMargin}" VerticalAlignment="Center"/>
                    <TextBlock VerticalAlignment="Center">复制</TextBlock>
                  </StackPanel>
                </Button>
              </StackPanel>
            </Grid>
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>
    </ScrollViewer>
  </Grid>
</UserControl>
