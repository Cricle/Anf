<div style="padding:2% 4% 0 4%">
    <div>
        <nz-progress [nzPercent]="this.mgr.allTotal==0?100:(((this.mgr.allCurrent+1)/this.mgr.allTotal)*100).toFixed(2)" 
            nz-tooltip [nzTooltipTitle]='this.mgr.allTotal==0?100:(((this.mgr.allCurrent+1)/this.mgr.allTotal)*100).toFixed(2)+"%"'
            [nzStrokeColor]="{ '0%': '#ABCDEFEE', '100%': '#12345699' }"
            [nzShowInfo]='false'></nz-progress>
    </div>
    <div *ngIf='this.mgr.processInfos'>
        <div>
            <h3 [ngStyle]="{ margin: '16px 0' }" nz-tooltip
                nzTooltipTitle="I'm sure I won't tell you it's single threaded">Task Quene
                ({{this.mgr.processInfos.length}})</h3>
            <nz-list nzSize="small" nzSplit="false">
                <nz-list-item *ngFor='let i of this.mgr.processInfos;' style="display: block;">
                    <div>
                        <div>
                            <nz-progress [nzPercent]="(((i.current+1)/i.total)*100).toFixed(2)"
                                [nzStrokeColor]="{ '0%': '#654321', '100%': '#123456' }" nzStatus="active"
                                [nzShowInfo]='false'></nz-progress>
                        </div>
                        <div>
                            <a [href]="i.detail.entity.comicUrl" style="margin-right:10px;">{{i.detail.entity.name}}</a>
                            <nz-spin  *ngIf='i.current+1!=i.total' nzSimple [nzIndicator]="indicatorTemplate" style="display: inline-block;">
                            </nz-spin>
                            <button nz-button nzType="text" nzDanger (click)='this.showInfo(i)'>
                                <i nz-icon nzType="check" nzTheme="outline"></i>
                            </button>
                            <button nz-button nzType="text" nzDanger (click)='this.remove(i)'>
                                <i nz-icon nzType="close" nzTheme="outline"></i>
                            </button>
                        </div>
                    </div>
                </nz-list-item>
            </nz-list>
        </div>
    </div>
</div>
<nz-drawer *ngIf='this.drawerVisible' [(nzVisible)]='this.drawerVisible'
    [nzTitle]='this.drawerComic&&this.drawerComic.detail.entity.name' [nzClosable]="true"
    (nzOnClose)='this.drawerVisible=false'
    [nzWidth]='drawerWith'>
    <ng-container>
        <div *ngIf='this.drawerComic!=null'>
            <p nz-typography>
                <nz-tag nzColor="#EEE">
                    <a [href]="this.drawerComic.detail.entity.comicUrl" target="_blank">Origin link</a>
                </nz-tag>
                <nz-tag nzColor="#ABC">
                    <a [href]='this.drawerComic.detail.entity.imageUrl' target="_blank">Logo Image Link</a>
                </nz-tag>
            </p>
            <h4 nz-typography>Description</h4>
            <p nz-typography nzEllipsis nzExpandable [nzEllipsisRows]="3">
                {{this.drawerComic.detail.entity.descript}}
            </p>
            <h4 nz-typography>Chapters (<strong>{{this.drawerComic.detail.chapters.length}}</strong>)</h4>
            <p nz-typography>
                <nz-collapse nzGhost  >
                    <nz-collapse-panel *ngFor='let i of this.drawerComic.detail.chapters;'
                     [nzHeader]="i.chapter.title"
                     [nzExtra]='extraTpl'>
                        <ng-template #extraTpl>
                            <a [href]='i.chapter.targetUrl' target="_blank">
                                <i nz-icon nzType="check"></i>
                            </a>
                        </ng-template>
                        <nz-list  nzSize="small" nzSplit="false">
                            <nz-list-item *ngFor="let page of i.pages;let ix=index;" >
                                <a [href]='page.targetUrl' target="_blank" nz-tooltip [nzTooltipTitle]='page.targetUrl'>Page: {{ix+1}}</a>
                            </nz-list-item>
                        </nz-list>
                    </nz-collapse-panel>
                </nz-collapse>
            </p>
        </div>
    </ng-container>
</nz-drawer>

<ng-template #indicatorTemplate><i nz-icon nzType="loading"></i></ng-template>